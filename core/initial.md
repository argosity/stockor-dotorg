---
commit: fc05a0410f95edb79a0490da11c0808b4dc81dd9
date: '2014-02-01'
---

**Stockor Core** is a Ruby Gem who's only dependency is ActiveRecord.  It includes the testing framework, migrations, model mixins, and other helper classes for the Gem.

Stockor is an opinionated framework.  When ever possible, it always attempts to support the simplest thing possible.

This means that it:

 * Supports only MRI Ruby version 2 (and later).  I'm guessing it'll probably work on other implementations but that's totally untested.  This allows the code base to make liberal use of named arguments for methods.

 * Requires ActiveRecord 4 (and by extension Rails 4 for other modules).  The main driver for this is simply to make things easier to test by only supporting the latest versions.  The codebase does make use of multi column pluck and a few features that are only in 4.

 * Will only support Postgresql 9.3 and later, and requires the following extensions be loaded: Plpgsql, HStore, pg_trgm, and JSON.  If you use the backport of JSON, you can probably run an earlier Postgresql.

 * Uses plain old Minitest and ActiveRecord fixtures instead of arguably better solutions.  This keeps the dependencies to a minimum.

 * Comments are plentiful and written in markdown format.  Documentation is generated by yardoc.

 * Actively attempts to keep features out of core.  Whenever possible they're better implemented as a plugin.

#### Migrations

While Stockor Core doesn't depend on Rails, it does detect if it's loaded.  If Rails is available, it configures itself as an engine with generators for installing it's migrations into Rails.

The migrations can be copied over by running:

    rails g skr:migrations:install

This will copy all the migrations into the standard Rails ``db/migrate`` directory.  They can then be executed with the standard ``rake db:migrate`` command.

For users who don't run Rails, fear not!  Stockor Core can also execute it's own migrations by:

    Skr::Core::DB.migrate

It's recommended that you run this from an IRB session or something connected to STDOUT so you can view the migration messages.

#### Unit Tests

Stockor Core uses standard MiniTest.  They all extend from Skr::UnitTest, which is just a thin wrapper over MiniTest::Unit::TestCase

Fixtures are written in plain old yaml and loaded using ActiveRecord's built-in support.

To make test-driven development easier, a Guard test runner is available that will auto-run the unit tests whenever a file is modified.  If you're helping with Stockor Core, ``bundle exec guard`` is your friend.

#### Documentation

All documentation on the code is generated by Yardoc and written using the markdown syntax.

#### Concerns

Stockor models make heavy use of Ruby meta programming techniques.  Most of the meta methods are implemented as a Concerns Module.

For instance the ``has_code_identifier`` class method is implemented in ``Skr::Concerns::CodeIdentifier`` and is included into the ``Skr::Model`` base class.

There are also Service Objects **(but we call them *Jobs*)** for some of the more involved business processes such as validating and placing a web order, importing sales from Amazon, and quoting a shipping rate.
